{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final##C5QgtiOF","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"customer_orders##O1OAKeNx":{"id":"customer_orders##O1OAKeNx","component":"Aggregate","metadata":{"label":"customer_orders","x":340,"y":120,"phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"DhXZ0HOz","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"urJCbxn4","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"orders##FY91PULL":{"id":"orders##FY91PULL","component":"Model","metadata":{"label":"orders","x":120,"y":140,"phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"vVpEj8aY","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##IVRQsFB0":{"id":"customer_payments##IVRQsFB0","component":"SQLStatement","metadata":{"label":"customer_payments","x":340,"y":340,"phase":0,"macroDependencies":[]},"properties":{"fileTabs":[{"path":"","id":"","language":"sql","content":"SELECT \n  orders.customer_id,\n  sum(amount) AS total_amount\n\nFROM payments\nLEFT JOIN orders\n   ON payments.order_id = orders.order_id\n\nGROUP BY orders.customer_id\n"}]},"ports":{"inputs":[{"id":"AkKr7VFn","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_ID","dataType":{"type":"Number"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Decimal","precision":38,"scale":6}}]},"slug":"payments"},{"id":"KeAUPqp9","schema":{"providerType":"Snowflake","fields":[{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"ORDER_DATE","dataType":{"type":"Date"}},{"name":"STATUS","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"SWMoNh7D","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"TOTAL_AMOUNT","dataType":{"type":"Decimal","precision":38,"scale":6}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customers##QH9r6TMz":{"id":"customers##QH9r6TMz","component":"Model","metadata":{"label":"customers","x":340,"y":540,"phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"sIGAPiY6","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_NAME","dataType":{"type":"String"}},{"name":"LAST_NAME","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final##C5QgtiOF":{"id":"final##C5QgtiOF","component":"Join","metadata":{"label":"final","x":540,"y":340,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"customer_payments","expression":{"expression":"customers.customer_id = customer_payments.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"}},{"expression":{"expression":"customer_payments.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"lbUa666n","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_NAME","dataType":{"type":"String"}},{"name":"LAST_NAME","dataType":{"type":"String"}}]},"slug":"customers"},{"id":"f22O1KJd","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}}]},"slug":"customer_orders"},{"id":"rOcjUI8z","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"TOTAL_AMOUNT","dataType":{"type":"Decimal","precision":38,"scale":6}}]},"slug":"customer_payments"}],"outputs":[{"id":"W9AHGoP9","schema":{"providerType":"Snowflake","fields":[{"name":"CUSTOMER_ID","dataType":{"type":"Number"}},{"name":"FIRST_NAME","dataType":{"type":"String"}},{"name":"LAST_NAME","dataType":{"type":"String"}},{"name":"FIRST_ORDER","dataType":{"type":"Date"}},{"name":"MOST_RECENT_ORDER","dataType":{"type":"Date"}},{"name":"NUMBER_OF_ORDERS","dataType":{"type":"Number"}},{"name":"CUSTOMER_LIFETIME_VALUE","dataType":{"type":"Decimal","precision":38,"scale":6}}]},"slug":"out"}],"isCustomOutputSchema":false}},"payments##rzNP50Au":{"id":"payments##rzNP50Au","component":"Model","metadata":{"label":"payments","x":120,"y":340,"phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"Ch00CuID","schema":{"providerType":"Snowflake","fields":[{"name":"PAYMENT_ID","dataType":{"type":"Number"}},{"name":"ORDER_ID","dataType":{"type":"Number"}},{"name":"PAYMENT_METHOD","dataType":{"type":"String"}},{"name":"AMOUNT","dataType":{"type":"Decimal","precision":38,"scale":6}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"FjCEOFQ4","source":"orders##FY91PULL","sourcePort":"vVpEj8aY","target":"customer_orders##O1OAKeNx","targetPort":"DhXZ0HOz"},{"id":"cEgRh4lR","source":"payments##rzNP50Au","sourcePort":"Ch00CuID","target":"customer_payments##IVRQsFB0","targetPort":"AkKr7VFn"},{"id":"xyPeEg2I","source":"orders##FY91PULL","sourcePort":"vVpEj8aY","target":"customer_payments##IVRQsFB0","targetPort":"KeAUPqp9"},{"id":"dXCCCYfq","source":"customers##QH9r6TMz","sourcePort":"sIGAPiY6","target":"final##C5QgtiOF","targetPort":"lbUa666n"},{"id":"eo37ldDv","source":"customer_orders##O1OAKeNx","sourcePort":"urJCbxn4","target":"final##C5QgtiOF","targetPort":"f22O1KJd"},{"id":"zyS2eqLi","source":"customer_payments##IVRQsFB0","sourcePort":"SWMoNh7D","target":"final##C5QgtiOF","targetPort":"rOcjUI8z"}],"component":"Model"}